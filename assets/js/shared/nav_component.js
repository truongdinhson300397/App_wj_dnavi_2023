// THIS FILE MUST BE IMPORT BEFORE js/shared/general.js

$(document).ready(onReady);
function onReady() {
  var currentPartner = window.location.href.split(/([0-9]{4})/g).slice(-1)[0].split('/')[1];
  var partnerId = parseInt(currentPartner);
  var contractTerm = globalInfo('contract_term');
  var user_contract_term = globalInfo('user_contract_term');
  var contractTermId = globalInfo("contract_term_id");
  var jwt = globalInfo('jwt_' + contractTermId);

  if (_.isEmpty(currentPartner)) {
    partnerId = 0;
  } else if (isNaN(partnerId)) {
    partnerId = globalInfo('partner_id');
  }

  // Logo url
  var $logo = $('.header-logo-a');
  var baseUrl = '/';
  if (parseInt(partnerId) !== 0) {
    baseUrl = '/' + partnerId;
  }
  $logo.attr('href', baseUrl);
  $logo.addClass('header-logo-' + contractTerm);

  var currentPage = $(location).attr('pathname');

  // DISABLE NAV FOR 2022
  var btnDisabled = '';

  var tabInternship = '';
  if (_.includes(currentPage, '/2022')) {
    tabInternship = '<li class="nav-ul-1-li">'+
                      '<a href="' + link.internshipList +'" class="nav-ul-1-li-a ' + btnDisabled + ' line-break">インターンシップ＆\n キャリア支援プログラム</a>'+
                    '</li>';
  }

  renderNavigation(partnerId, btnDisabled, tabInternship);
}

function renderNavigation(partnerId, btnDisabled, tabInternship) {
  var eventUrl = link.eventList;
  if (partnerId && parseInt(partnerId) !== 0) {
    eventUrl = '/' + partnerId + link.eventList;
  }

  var navigation = (
    '<div class="nav-inner">'+
      '<div class="nav-main">'+
        '<ul class="nav-ul-1">'+
          '<li class="nav-ul-1-li">'+
            '<a href="' + eventUrl + '" class="nav-ul-1-li-a line-height">イベント</a>'+
          '</li>'+
          '<li class="nav-ul-1-li">'+
            '<a href="' + link.disclosure + '" class="nav-ul-1-li-a ' + btnDisabled + ' line-height">情報公開度でさがす</a>'+
          '</li>'+
          '<li class="nav-ul-1-li">'+
            '<a href="' + link.companyList + '" class="nav-ul-1-li-a ' + btnDisabled + ' line-height">企業をさがす</a>'+
          '</li>'+
          tabInternship +
          // '<li class="nav-ul-1-li">'+
          //   '<a href="' + link.internshipList +'" class="nav-ul-1-li-a">インターンシップ</a>'+
          // '</li>'+
          '<li class="nav-ul-1-li nav-1-has-submenu ' + btnDisabled + '">'+
            '<a href="#" id="nav1LiIcon" class="nav-ul-1-li-a ' + btnDisabled + ' line-height">UIターン・地元就活 <span id="nav1ArrowIcon" class="nav-1-has-submenu-arrow"></span></a>'+
            '<div class="nav-ul-2-outer">'+
              '<ul class="nav-ul-2" id="ui-job-hunting">'+
                '<!--generated by js-->'+
              '</ul>'+
            '</div>'+
          '</li>'+
          '<li class="nav-ul-1-li">'+
            '<a href="' + link.contents + '" class="nav-ul-1-li-a line-height">選考対策</a>'+
          '</li>'+
        '</ul>'+
      '</div>'+
    '</div>'
  );
  $("#nav").append(navigation);
}
